<!DOCTYPE html>
<html>
	﻿<head>
		<title>Services hébergés</title>
		<meta charset="UTF-8" />
		<link type="text/css" href="include/style.css" rel="stylesheet" />
	</head>
	<body>
		<div id="page">
			<div id="title">
				<img src="img/header.gif" alt="useless header"  />
			</div>
			<div id="main">
				<p>Installer Raspbian</p>
				<p>Installer Apache</p>
				<p>Installer Owncloud</p>
				<p>Installer Transmission</p>
				<h1>Configurer le NFS</h1>
				<p>Les explications ont été prise sur <a href="http://doc.ubuntu-fr.org/nfs">ubuntu-fr</a>.</p>
				<p>
					Deux machines impliqué&nbsp;: Le client (192.168.0.1) et le serveur (192.168.0.3). 
					Le serveur est le Raspberry PI.
					Sur le serveur&nbsp;:
				</p>
				<h2>Côté serveur</h2>
				<p class="code">
					apt-get install nfs-kernel-server
				</p>
				<p>
					Ajouter une ligne par répertoire à partager sur le nfs dans le fichier <span class="fichier">/etc/exports</span>.
				</p>
				<p class="code">
					/home/pi/Téléchargements 192.168.0.0/24(ro,sync,all_squash,anonuid=1000,anongid=1000)
				</p>
				<p>
					Puis on redémarre le service&nbsp;:
				</p>
				<p class="code">
					service nfs-kernel-server restart
				</p>
				<h2>Côté client</h2>
				<p>
					Tester que le partage fonctionne bien avec un montage bidon&nbsp;:
				</p>
				<p class="code">
					mount 192.168.0.3:/home/pi/Téléchargements tmp/
				</p>
				<p>
					Puis rendre le montage automatique avec <a href="http://doc.ubuntu-fr.org/autofs#nfs">AutoFS</a>. On pourrais utiliser le fichier /etc/fstab mais comme on n'est pas systématiquement dans le réseau local, on risque d'avoir des soucis lorsque le montage ne se passe pas correctement.
				</p>
				<p>
					Tout d'abord, mettre dans le fichier <span class="fichier">/etc/auto.master</span>&nbsp;:
				</p>
				<p class="code">
					/mnt/pi	/etc/auto.nfs --ghost,--timeout=60
				</p>
				<p>
					Le répertoire <em>/mnt/pi</em> ne doit pas forcément exister. AutoFS s'occupera de le créer si nécessaire avec les droits correctement définis. Enfin, modifier le fichier <em>/etc/auto.nfs</em>&nbsp;:
				</p>
				<p class="code">
					Telechargements -fstype=nfs4,ro 192.168.0.3:/home/pi/Téléchargements
				</p>
				<p>
					Un répertoire /mnt/pi/Telechargements existe alots avec pour contenu le partage NFS.
					/!ATTENTION!\ La présence d'accent dans le nom du partage local (Telechargements) risque d'empêcher le fonctionnement du montage.<br/>
					Enfin, redémarrer le service autofs&nbsp;:
				</p>
				<p class="code">
					service autofs stop && service autofs start
				</p>
			</div>
			﻿<div id="footer">
				<a href="http://validator.w3.org/check?uri=referer">
					<img src="http://www.w3.org/Icons/valid-xhtml10" alt="Valid XHTML 1.0 Strict" height="31" width="88" />
				</a>
				<a href="http://jigsaw.w3.org/css-validator/check?uri=referer">
					<img src="http://www.w3.org/Icons/valid-css2" alt="Valid CSS2" height="31" width="88" />
				</a>
			</div>
		</div>
	</body>
</html>